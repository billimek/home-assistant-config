################################################
## Sensor timeout alerts (using blueprint)
################################################
## Replaces 5 automations with blueprint instances
- id: timeout_door_to_garage
  alias: 'Alert when door to garage is opened for too long'
  use_blueprint:
    path: custom/sensor_alert_timeout.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_garage_door
      sensor_name: "Door to garage"
      timeout_seconds: 300
      notify_jeff: true
      notify_jen: true

- id: timeout_basement_door
  alias: 'Alert when basement door is opened for too long'
  use_blueprint:
    path: custom/sensor_alert_timeout.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_basement_door
      sensor_name: "Basement door"
      timeout_seconds: 300
      notify_jeff: true
      notify_jen: true

- id: timeout_front_door
  alias: 'Alert when front door is opened for too long'
  use_blueprint:
    path: custom/sensor_alert_timeout.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_front_door
      sensor_name: "Front door"
      timeout_seconds: 300
      notify_jeff: true
      notify_jen: true

- id: timeout_sun_room_door
  alias: 'Alert when sun room door is opened for too long'
  use_blueprint:
    path: custom/sensor_alert_timeout.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_sun_room_door
      sensor_name: "Sun room door"
      timeout_seconds: 300
      notify_jeff: true
      notify_jen: true

- id: timeout_unknown_door
  alias: 'Alert when unknown door is opened for too long'
  use_blueprint:
    path: custom/sensor_alert_timeout.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_unknown_door
      sensor_name: "Unknown door"
      timeout_seconds: 300
      notify_jeff: true
      notify_jen: true

################################################
## Sensor alerts when away (using blueprint)
################################################
## Replaces 15 automations with blueprint instances
- id: away_upstairs_motion
  alias: 'Alert when motion is detected upstairs and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_upstairs_motion
      sensor_name: "Upstairs motion detected"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_main_motion
  alias: 'Alert when motion is detected on the main level and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_main_motion
      sensor_name: "Main level motion detected"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_basement_motion
  alias: 'Alert when motion is detected in the basement and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_basement_motion
      sensor_name: "Basement motion detected"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_front_door
  alias: 'Alert when front door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_front_door
      sensor_name: "Front door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_garage_door
  alias: 'Alert when garage door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_garage_door
      sensor_name: "Garage door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_family_window
  alias: 'Alert when family window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_family_window
      sensor_name: "Family window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_living_window
  alias: 'Alert when living window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_living_window
      sensor_name: "Living window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_sun_room_door
  alias: 'Alert when sun room door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_sun_room_door
      sensor_name: "Sun Room Door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_bathroom_window
  alias: 'Alert when bathroom window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_bathroom_window
      sensor_name: "Bathroom Window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_kitchen_window
  alias: 'Alert when kitchen window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_kitchen_window
      sensor_name: "Kitchen Window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_unknown_door
  alias: 'Alert when unknown door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_unknown_door
      sensor_name: "Unknown Door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_laundry_window
  alias: 'Alert when laundry window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_laundry_window
      sensor_name: "Laundry Window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_basement_door
  alias: 'Alert when basement door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_basement_door
      sensor_name: "Basement Door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_sliding_door
  alias: 'Alert when sliding door is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_sliding_door
      sensor_name: "Sliding Door"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

- id: away_upstairs_window
  alias: 'Alert when upstairs window is open and nobody home'
  use_blueprint:
    path: custom/sensor_alert_when_away.yaml
    input:
      sensor_entity: binary_sensor.ser2sock_10000_upstairs_window
      sensor_name: "Upstairs Window"
      presence_sensor: sensor.anyone_home
      notify_service: notify.mobile_app_jeffsphone

################################################
## iOS/Mobile app actions
################################################
- id: ios_action_disarm_alarm
  alias: 'iOS action to disarm alarm'
  initial_state: on
  trigger:
    - platform: event
      event_type: mobile_app_notification_action
      event_data:
        action: DISARM_ALARM
  action:
    - service: alarm_control_panel.ser2sock_10000_alarm_disarm
      data:
        entity_id: alarm_control_panel.ser2sock_10000_alarm_panel
        code: !env_var ALARMCD
